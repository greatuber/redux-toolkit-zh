---
id: examples
title: RTK Query 示例
sidebar_label: RTK Query 示例
hide_title: true
description: 'RTK Query > Usage > Examples: sandboxes with runnable apps'
---

&nbsp;

# RTK 查询示例

## 示例概述

我们有各种示例，展示了使用 RTK Query 的各个方面。

这些示例并不意味着你应该以此为基础来构建你的应用程序，而是存在于展示你在应用程序中可能不需要或不想要的_非常特定_的行为。对于大多数用户来说，[查询](./queries)和[变异](./mutations)部分的基本示例将覆盖你的大部分需求。

:::tip

请注意，当你在 CodeSandbox 中尝试示例时，可能会遇到奇怪的行为，特别是当你复制它们并开始编辑文件时。热重载、CSB 服务工作者和 [`msw`](https://mswjs.io/) 有时会有问题，无法进入正确的页面 -- 当发生这种情况时，只需在 CSB 浏览器窗格中刷新即可。

:::

## 厨房水槽

<iframe
  src="https://codesandbox.io/embed/github/reduxjs/redux-toolkit/tree/master/examples/query/react/kitchen-sink?fontsize=12&hidenavigation=1&theme=dark&runonclick=1"
  style={{
    width: '100%',
    height: '800px',
    border: 0,
    borderRadius: '4px',
    overflow: 'hidden',
  }}
  title="RTK Query Kitchen Sink Example"
  allow="geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb"
  sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin"
></iframe>

## React 乐观更新

在下面的示例中，你会注意到一些事情。侧边栏上有两个 `Posts` 列表。顶部的那个只有在成功的变异和与服务器重新同步 _之后_ 才会更新。_订阅_ 的那个由于乐观更新会立即更新。在出现错误的情况下，你会看到这个操作被回滚。

:::info
示例中有一些故意设置的奇怪行为... 当编辑帖子的名称时，你很可能会遇到随机错误。
:::

<iframe
  src="https://codesandbox.io/embed/github/reduxjs/redux-toolkit/tree/master/examples/query/react/optimistic-update?fontsize=12&hidenavigation=1&module=%2Fsrc%2Fapp%2Fservices%2Fposts.ts&theme=dark&runonclick=1"
  style={{
    width: '100%',
    height: '800px',
    border: 0,
    borderRadius: '4px',
    overflow: 'hidden',
  }}
  title="RTK Query Optimistic Update Example"
  allow="geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb"
  sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin"
></iframe>

## React 与 GraphQL

<iframe
  src="https://codesandbox.io/embed/github/reduxjs/redux-toolkit/tree/master/examples/query/react/graphql?fontsize=12&hidenavigation=1&theme=dark&module=%2Fsrc%2Fapi.js&runonclick=1"
  style={{
    width: '100%',
    height: '800px',
    border: 0,
    borderRadius: '4px',
    overflow: 'hidden',
  }}
  title="RTK Query GraphQL Example"
  allow="geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb"
  sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin"
></iframe>

## 认证

有多种方式可以使用 RTK Query 处理认证。这是一个非常基础的示例，从登录变异中获取 JWT，然后将其设置在我们的存储中。然后我们使用 `prepareHeaders` 将认证头注入到每个后续请求中。

### 分发一个动作来设置用户状态

这个示例分发一个 `setCredentials` 动作来存储用户和令牌信息。

<iframe
  src="https://codesandbox.io/embed/github/reduxjs/redux-toolkit/tree/master/examples/query/react/authentication?fontsize=12&hidenavigation=1&module=%2Fsrc%2Ffeatures%2Fauth%2FauthSlice.tsx&theme=dark&runonclick=1"
  style={{
    width: '100%',
    height: '800px',
    border: 0,
    borderRadius: '4px',
    overflow: 'hidden',
  }}
  title="RTK Query Authentication Example"
  allow="geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb"
  sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin"
></iframe>

### 使用 `extraReducers`

这个示例使用了 `authSlice` 中的 `extraReducers` 和端点的匹配器。

<iframe
  src="https://codesandbox.io/embed/github/reduxjs/redux-toolkit/tree/master/examples/query/react/authentication-with-extrareducers?fontsize=12&hidenavigation=1&module=%2Fsrc%2Ffeatures%2Fauth%2FauthSlice.tsx&theme=dark&runonclick=1"
  style={{
    width: '100%',
    height: '800px',
    border: 0,
    borderRadius: '4px',
    overflow: 'hidden',
  }}
  title="RTK Query Authentication Example - extraReducers"
  allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking"
  sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"
></iframe>

## React 类组件

查看 `PostDetail` 组件，了解类组件的使用示例。

<iframe
  src="https://codesandbox.io/embed/react-class-component-example-48hyq?fontsize=12&hidenavigation=1&theme=dark&runonclick=1"
  style={{
    width: '100%',
    height: '800px',
    border: 0,
    borderRadius: '4px',
    overflow: 'hidden',
  }}
  title="RTK Query React Class Components Example"
  allow="geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb"
  sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin"
></iframe>

## Svelte

<iframe
  src="https://codesandbox.io/embed/svelte-app-rtk-simplequery-demo-f1ueb?fontsize=12&hidenavigation=1&theme=dark&runonclick=1"
  style={{
    width: '100%',
    height: '800px',
    border: 0,
    borderRadius: '4px',
    overflow: 'hidden',
  }}
  title="RTK Query Svelte Example"
  allow="geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb"
  sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin"
></iframe>
